<style>
    .list-container { display: flex; flex-direction: column; gap: 20px; padding-bottom: 100px; }
</style>

<div class="list-container" id="container"></div>

<script>
    $loader.registerComponent('comp-word-card', './components/comp-word-card.html');

    $watch('list-data', (newVal) => {
        try {
            const list = JSON.parse(newVal || '[]');
            renderList(list);
        } catch(e) { console.error('JSON Parse Error:', e); }
    });

    function renderList(list) {
        const container = $scope.querySelector('#container');
        container.innerHTML = ''; 

        list.forEach(item => {
            const card = document.createElement('comp-word-card');
            
            // 关键：将对象转为单引号包裹的 JSON 字符串，防止 HTML 属性解析错误
            // 或者直接使用 DOM 属性赋值（由于 ComponentLoader V3 监听 attribute，所以我们用 setAttribute）
            card.setAttribute('card-data', JSON.stringify(item));
            
            // 手动绑定事件
            card.addEventListener('edit', (e) => $emit('edit', e.detail));
            card.addEventListener('delete', (e) => $emit('delete', e.detail));

            container.appendChild(card);
        });
    }
</script>