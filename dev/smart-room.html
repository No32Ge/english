<style>
    .room-card {
        background: white; border-radius: 12px; padding: 20px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.05); width: 300px;
        display: flex; flex-direction: column;
    }
    h3 { margin: 0 0 15px 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
    .device-list { flex: 1; }
    /* 预留给 footer 的容器 */
    #footer-slot { margin-top: auto; }
</style>

<template>
    <div class="room-card">
        <h3 s-text="roomName">房间名</h3>
        
        <div class="device-list">
            <!-- [嵌套组件] 使用子组件 -->
            <!-- 将父组件的数据传给子组件 -->
            <device-switch name="顶灯" s-bind:active="lightStatus"></device-switch>
            <device-switch name="空调" s-bind:active="acStatus"></device-switch>
        </div>

        <!-- [Raw Import 容器] 用来放动态加载的原生片段 -->
        <div id="footer-slot"></div>
    </div>
</template>

<script>
    // 1. 注册子组件
    $loader.registerComponent('device-switch', './device-switch.html');

    // 2. 初始化数据
    $state.roomName = 'Loading...';
    $state.lightStatus = 'false';
    $state.acStatus = 'false';

    // 3. 监听属性 (Props Down)
    $watch('title', (val) => $state.roomName = val);
    
    // 4. [演示需求: 组件内导入原生模板]
    // 动态加载 simple-footer.html 并插入到 #footer-slot
    (async () => {
        // 使用工具箱里的 importHtml
        const footerNode = await $loader.importHtml('./simple-footer.html');
        $scope.querySelector('#footer-slot').appendChild(footerNode);
        console.log('组件内部: 已动态加载原生 Footer');
    })();

    // 5. 简单的逻辑控制
    // 假设这是“一键全开”功能
    $watch('master', (val) => {
        if (val === 'on') {
            $state.lightStatus = 'true';
            $state.acStatus = 'true';
        }
    });

</script>